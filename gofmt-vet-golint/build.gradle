import com.github.blindpirate.gogradle.Go

plugins {
    id 'com.github.blindpirate.gogradle' version '0.4.7'
}
golang {
    packagePath = 'github.com/my/package' // go import path of project to be built, NOT local file system path!
}

goBuild.dependsOn goCheck

gofmt {
    doLast {
        gofmt '-e .'
    }
}

goVet {
    continueWhenFail = true
    doLast {
        go 'tool vet -v .'
    }
}

// You should make sure golint is in your $PATH
task golint(type: Go){
    continueWhenFail = true
    doLast {
        run('golint github.com/my/package', { stdout, stderr ->
             new File('./stdout.txt').write(stdout)
             new File('./stderr.txt').write(stderr)
        })
    }
}

goCheck.dependsOn golint
